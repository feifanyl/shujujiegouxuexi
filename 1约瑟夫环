#include <stdio.h>
#include <stdlib.h>
typedef struct node{
    int id;
    int key;
    struct node * next;
}person;
person * initLink(int n){
    int key;
    person * head=(person*) malloc(sizeof(person));
    head->id=1;
    printf("请输入1的key:");//单独定义第一个节点的key
    scanf("%d",&key);
    head->key=key;
    head->next=NULL;
    person * cyclic=head;
    for(int i=2;i<=n;i++){
        person * body=(person*)malloc(sizeof(person));
        body->id=i;
        printf("请输入%d的key:",i);
        scanf("%d",&key);
        body->key=key;
        body->next=NULL;
        cyclic->next=body;
        cyclic=cyclic->next;
    }
    cyclic->next=head;//头尾相连变成循环链表
    return head;
}
void findAndKill(person * head,int m){
    person * tail=head;//用于保存当前节点方便删除
    person * p=head;
    for(int i=1;i<m;i++){
        tail=p;
        p=p->next;
    }
    while (p->next!=p){
        int j=p->key;
        printf("出列:%d\n",p->id);
        tail->next=p->next;
        free(p);
        p=tail;
        for (int i = 0; i < j; i++) {
            tail=p;
            p=p->next;
        }
    }
    printf("出列:%d\n",p->id);
}
int main(void){
    int n;
    int m;
    printf("请输入人数N:");
    scanf("%d",&n);
    printf("请输入初始报数M:");
    scanf("%d",&m);
    person * head= initLink(n);
    findAndKill(head,m);
}
